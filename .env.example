# =============================================================================
# Keycloak Docker Compose Environment Configuration
# Copy this file to .env and fill in your values:  cp .env.example .env
# =============================================================================

# -- Docker / Build Settings --
# Keycloak base version (used by Dockerfile to pull the right image)
KEYCLOAK_VERSION=26.5.2
# Tag for the custom-built image (includes 2FA email OTP plugin)
KEYCLOAK_IMAGE=keycloak-custom:latest
# Container name for easy reference in docker commands
KEYCLOAK_CONTAINER_NAME=keycloak
# Port exposed on the host machine
KEYCLOAK_HOST_PORT=18080
# Port inside the container (rarely needs changing)
KEYCLOAK_CONTAINER_PORT=8080

# -- PostgreSQL --
# Postgres image tag
POSTGRES_IMAGE=postgres:17-alpine
# Container name
POSTGRES_CONTAINER_NAME=keycloak-postgres
# Port exposed on host (set to different port if 5432 is already in use)
POSTGRES_HOST_PORT=5432
# Database name for Keycloak
POSTGRES_DB=keycloak
# Database credentials
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme

# -- Keycloak Admin Bootstrap Credentials --
# These are used ONLY on first startup to create the initial admin user.
# CHANGE THESE for any non-local deployment.
KC_BOOTSTRAP_ADMIN_USERNAME=admin
KC_BOOTSTRAP_ADMIN_PASSWORD=changeme

# -- Hostname / Proxy Configuration --
# The public-facing URL of your Keycloak instance.
# For ngrok: https://<your-subdomain>.ngrok-free.app
# For production: https://auth.yourdomain.com
KC_HOSTNAME=https://your-hostname-here.example.com
# Set to false to allow Keycloak to respond on any hostname
KC_HOSTNAME_STRICT=false
# Enable HTTP (required when running behind a reverse proxy that terminates TLS)
KC_HTTP_ENABLED=true
# Proxy header mode. Use "xforwarded" for nginx/ngrok.
KC_PROXY_HEADERS=xforwarded

# -- Database Connection --
# Database vendor (no need to change - Keycloak connects to the postgres service above)
KC_DB=postgres

# -- Theme Configuration --
# Path to the theme directory on the host (relative to docker-compose.yml)
KEYCLOAK_THEME_DIR=./theme

# -- Logging --
# Log levels: fatal, error, warn, info, debug, trace, all, off
KC_LOG_LEVEL=info

# -- Development Settings --
# Disable theme caching for live-reload during development.
# Set to "true" in production for performance.
KC_SPI_THEME_STATIC_MAX_AGE=-1
KC_SPI_THEME_CACHE_THEMES=false
KC_SPI_THEME_CACHE_TEMPLATES=false
